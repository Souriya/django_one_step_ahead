{% extends "base.html" %}
{% load static %}
{% load widget_tweaks %}

{% block main-content %}
 <div class="w3-col s12 w3-container w3-center"

    <div class="w3-card w3-container">
        <header class="w3-container">
          <h2 class="lao-noto">{{ user.first_name}} {{ user.last_name }}</h2>
        </header>
    </div>

    <div class="w3-container w3-section w3-center w3-mobile">
        <a href="{% url 'core:user_list' %}"><i class="material-icons w3-button w3-text-red w3-xxxlarge">add_circle</i></a>
        <span class="lao-noto"><strong>New Appointment</strong></span>
    </div>


    <div class="w3-container w3-margin-bottom">

      <div class="w3-row">
        <a href="javascript:void(0)" onclick="openTab(event, 'Confirmed');">
          <div class="w3-third tablink w3-bottombar w3-hover-light-grey w3-padding w3-mobile">Accepted</div>
        </a>
        <a href="javascript:void(0)" onclick="openTab(event, 'Pending');">
          <div class="w3-third tablink w3-bottombar w3-border-blue w3-padding w3-mobile">Pending</div>
        </a>
        <a href="javascript:void(0)" onclick="openTab(event, 'Decline');">
          <div class="w3-third tablink w3-bottombar w3-hover-light-grey w3-padding w3-mobile">Declined</div>
        </a>
      </div>

      <div id="Confirmed" class="w3-container tab" style="display:none">
          <br>
         <div class="w3-container w3-card">
            <h4>Inbox</h4>
            <div class="w3-container">
                <ul class="w3-ul">
                    {% for i in request_accepted_in %}
                        <li>
                            {{ i.source_name }}
                            {{ i.source_last_name }}
                            ({{ i.source_position }}). Time:
                            {{ i.time_slot }}. Location:
                            {{ i.location.name }}
                        </li>
                    {% endfor %}
                </ul>
            </div>
         </div>
         <div class="w3-container w3-card">
            <h4>Outbox</h4>
            <div class="w3-container">
                <ul class="w3-ul">
                    {% for i in request_accepted_out %}
                        <li>
                            {{ i.destination_name }}
                            {{ i.destination_last_name }}
                            ({{ i.destination_position }}). Time:
                            {{ i.time_slot }}. Location:
                            {{ i.location.name }}
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
      </div>
      <div id="Pending" class="w3-container tab" style="display:block">
          <br>
           <div class="w3-container w3-card">
              <h4>Inbox</h4>

                  <div class="w3-container">
                        <ul class="w3-ul">
                            {% for i in request_pending_in %}
                                <li>
                                    {{ i.source_name }}
                                    {{ i.source_last_name }}
                                    ({{ i.source_position }}). Time:
                                    {{ i.time_slot }}. Location:
                                    {{ i.location.name }}

                                    <div class="w3-center">
                                        <a href="{% url 'core:request_meeting_accept_decline' i.id 2 %}">
                                            <i class="material-icons w3-button w3-text-green w3-xxlarge">check_circle</i>
                                        </a>
                                        <a href="{% url 'core:request_meeting_accept_decline' i.id 3 %}">
                                            <i class="material-icons w3-button w3-text-red w3-xxlarge">cancel</i>
                                        </a>
                                    </div>
                                </li>
                            {% endfor %}
                        </ul>
                  </div>

           </div>
           <div class="w3-container w3-card">
              <h4>Outbox</h4>
              <div class="w3-container">
                    <ul class="w3-ul">
                        {% for i in request_pending_out %}
                                 <li>
                                     {{ i.destination_name }}
                                     {{ i.destination_last_name }}
                                     ({{ i.destination_position }}). Time:
                                     {{ i.time_slot }}. Location:
                                     {{ i.location.name }}
                                 </li>
                        {% endfor %}
                    </ul>
              </div>
           </div>
      </div>

      <div id="Decline" class="w3-container tab" style="display:none">
          <br>
           <div class="w3-container w3-card">
              <h4>Inbox</h4>
              <div class="w3-container">
                  <ul class="w3-ul">
                      {% for i in request_declined_in %}
                               <li>
                                   {{ i.source_name }}
                                   {{ i.source_last_name }}
                                   ({{ i.source_position }}). Time:
                                   {{ i.time_slot }}. Location:
                                   {{ i.location.name }}
                               </li>
                      {% endfor %}
                  </ul>
              </div>
           </div>
           <div class="w3-container w3-card">
              <h4>Outbox</h4>
              <div class="w3-container">
                  <ul class="w3-ul">
                      {% for i in request_declined_out %}
                               <li>
                                   {{ i.destination_name }}
                                   {{ i.destination_last_name }}
                                   ({{ i.destination_position }}). Time:
                                   {{ i.time_slot }}. Location:
                                   {{ i.location.name }}
                               </li>
                      {% endfor %}
                  </ul>
              </div>
           </div>
      </div>
    </div>

    <script>
    function openTab(evt, tab) {
      var i, x, tablinks;
      x = document.getElementsByClassName("tab");
      for (i = 0; i < x.length; i++) {
        x[i].style.display = "none";
      }
      tablinks = document.getElementsByClassName("tablink");
      for (i = 0; i < x.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" w3-border-blue", "");
      }
      document.getElementById(tab).style.display = "block";
      evt.currentTarget.firstElementChild.className += " w3-border-blue";
    }
    </script>

</div>
{% endblock %}

{% block js %}

    <script>
        function autoRefresh() {
            location.reload();
        }
        setInterval(autoRefresh, 60000); // 60000 milliseconds = 1 minute
    </script>

{% endblock %}
